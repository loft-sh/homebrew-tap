# typed: false
# frozen_string_literal: true

# This file was generated by GoReleaser. DO NOT EDIT.
class VclusterExperimental < Formula
  desc "Creates fully functional virtual k8s cluster inside host k8s cluster's namespace"
  homepage "https://www.vcluster.com"
  version "0.21.0-beta.4"
  license "Apache-2.0"

  depends_on "helm"
  depends_on "kubernetes-cli"

  on_macos do
    on_intel do
      url "https://github.com/loft-sh/vcluster/releases/download/v0.21.0-beta.4/vcluster-darwin-amd64"
      sha256 "813d572f29a6f0ec7c4d9426b7415866e0d24ce23a56b4706d2a3a46e9eebf37"

      def install
        bin.install "vcluster-darwin-amd64" => "vcluster"
      end
    end
    on_arm do
      url "https://github.com/loft-sh/vcluster/releases/download/v0.21.0-beta.4/vcluster-darwin-arm64"
      sha256 "c64ac6419f4dc8c8f832e25281ee612463f89a64fa49510de304e2a6de6711c9"

      def install
        bin.install "vcluster-darwin-arm64" => "vcluster"
      end
    end
  end

  on_linux do
    on_intel do
      if Hardware::CPU.is_64_bit?
        url "https://github.com/loft-sh/vcluster/releases/download/v0.21.0-beta.4/vcluster-linux-amd64"
        sha256 "3b44491afb3a01a6fe0bb83879e660df825d68fae2c9522428f49aee7a7ad6d7"

        def install
          bin.install "vcluster-linux-amd64" => "vcluster"
        end
      end
    end
    on_arm do
      if !Hardware::CPU.is_64_bit?
        url "https://github.com/loft-sh/vcluster/releases/download/v0.21.0-beta.4/vcluster-linux-arm"
        sha256 "e585756baf023f7af68177c1240f1cbfeac6108e958b2b692c5f9ac3a6e54d72"

        def install
          bin.install "vcluster-linux-arm" => "vcluster"
        end
      end
    end
    on_arm do
      if Hardware::CPU.is_64_bit?
        url "https://github.com/loft-sh/vcluster/releases/download/v0.21.0-beta.4/vcluster-linux-arm64"
        sha256 "6ea1d306f7445abaa64b7928504cfe8d4ab9a02eb45e8b6ca03040790ec979b1"

        def install
          bin.install "vcluster-linux-arm64" => "vcluster"
        end
      end
    end
  end

  conflicts_with "vcluster"
  conflicts_with "loft-sh/tap/vcluster"

  test do
    help_output = "vcluster root command"
    assert_match help_output, shell_output("#{bin}/vcluster --help")
  end
end
