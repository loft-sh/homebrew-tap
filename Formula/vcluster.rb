# typed: false
# frozen_string_literal: true

# This file was generated by GoReleaser. DO NOT EDIT.
class Vcluster < Formula
  desc "Creates fully functional virtual k8s cluster inside host k8s cluster's namespace"
  homepage "https://www.vcluster.com"
  version "0.15.3"
  license "Apache-2.0"

  depends_on "helm"
  depends_on "kubernetes-cli"

  on_macos do
    if Hardware::CPU.arm?
      url "https://github.com/loft-sh/vcluster/releases/download/v0.15.3/vcluster-cli_Darwin_arm64.tar.gz"
      sha256 "9b58b290fe3a8d623392dff52ecd4d99400e1ec8f6903b8de353ea9fb3422143"

      def install
        bin.install "vcluster"
        generate_completions_from_executable(bin/"vcluster", "completion")
      end
    end
    if Hardware::CPU.intel?
      url "https://github.com/loft-sh/vcluster/releases/download/v0.15.3/vcluster-cli_Darwin_x86_64.tar.gz"
      sha256 "4e629bd84ff0879397840fbe1d020cd907d118173e90d8742a712e9a1ccd07ee"

      def install
        bin.install "vcluster"
        generate_completions_from_executable(bin/"vcluster", "completion")
      end
    end
  end

  on_linux do
    if Hardware::CPU.arm? && !Hardware::CPU.is_64_bit?
      url "https://github.com/loft-sh/vcluster/releases/download/v0.15.3/vcluster-cli_Linux_armv6.tar.gz"
      sha256 "e37b47526b4d79a0a8b9ace54951c989c48bd84260b26fba13993daecf80ea90"

      def install
        bin.install "vcluster"
        generate_completions_from_executable(bin/"vcluster", "completion")
      end
    end
    if Hardware::CPU.intel?
      url "https://github.com/loft-sh/vcluster/releases/download/v0.15.3/vcluster-cli_Linux_x86_64.tar.gz"
      sha256 "5a8946f96ff5f374035b41613e5ce10565cfb98ab6c721e756599cda5d1bf786"

      def install
        bin.install "vcluster"
        generate_completions_from_executable(bin/"vcluster", "completion")
      end
    end
    if Hardware::CPU.arm? && Hardware::CPU.is_64_bit?
      url "https://github.com/loft-sh/vcluster/releases/download/v0.15.3/vcluster-cli_Linux_arm64.tar.gz"
      sha256 "0006a2d71d2b59f85e308e0ff0a0c67e31e78fe2ddfa89570771bcc1671ed77c"

      def install
        bin.install "vcluster"
        generate_completions_from_executable(bin/"vcluster", "completion")
      end
    end
  end

  test do
    help_output = "vcluster root command"
    assert_match help_output, shell_output("#{bin}/vcluster --help")
  end
end
